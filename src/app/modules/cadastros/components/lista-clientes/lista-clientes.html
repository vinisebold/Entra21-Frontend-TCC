@if (mostrarModalCliente()) {
<app-formulario-cliente
  (fechar)="closeClienteModal()"
  (salvo)="onClienteSalvo()"
></app-formulario-cliente>
}

<section
  role="region"
  aria-label="Clientes"
  class="flex flex-col p-4 bg-surface-container rounded-xl h-full"
>
  <header
    class="flex items-center gap-3 rounded-lg bg-surface p-6 z-5 shadow-lg"
  aria-label="Cabeçalho Clientes"
  >
    <svg class="icone-38" aria-hidden="true" focusable="false">
      <use [attr.href]="'/sprite.svg#icon-pessoas'"></use>
    </svg>

    <h2 class="title-big leading-none text-on-surface">Clientes</h2>

    <div class="ms-auto">
      <app-botao
        label="Adicionar Cliente"
        (buttonClick)="abrirClienteModal()"
      ></app-botao>
    </div>
  </header>

  <div class="flex-1 rounded-lg px-4">
    @if (carregando()) {
      <div class="flex justify-center items-center h-32">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
        <span class="ml-2 text-on-surface-variant">Carregando clientes...</span>
      </div>
  } @else if (erro()) {
      <div class="flex flex-col justify-center items-center h-32 text-center">
        <svg class="w-12 h-12 text-error mb-2" aria-hidden="true">
          <use [attr.href]="'/sprite.svg#icon-error'"></use>
        </svg>
  <p class="text-error body-large">{{ erro() }}</p>
        <button 
          type="button"
          class="mt-2 px-4 py-2 bg-primary text-on-primary rounded-lg"
          (click)="carregarClientes()"
        >
          Tentar novamente
        </button>
      </div>
  } @else {
      <ul
        role="list"
        style="max-height: calc(100vh - 250px)"
        class="flex flex-col overflow-y-auto"
        aria-label="Lista de Clientes"
      >
        @for (cliente of clientes(); track cliente.id) {
        <li
          role="listitem"
          class="group relative rounded-xl border border-[#f0f0f0] bg-white p-4 shadow-soft m-2"
        >
          <app-cliente-item [cliente]="cliente" />

          <div
            class="absolute top-4 right-4 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200"
          >
            <!-- Editar -->
            <button
              type="button"
              aria-label="Editar Cliente"
              class="flex h-10 w-10 items-center justify-center rounded-full bg-transparent text-on-surface-variant hover:bg-gray-100"
            >
              <svg class="w-6 h-6" aria-hidden="true">
                <use [attr.href]="'/sprite.svg#icon-editar'"></use>
              </svg>
            </button>

            <!-- Excluir -->
            <button
              type="button"
              aria-label="Excluir Cliente"
              class="flex h-10 w-10 items-center justify-center rounded-full bg-transparent text-on-surface-variant hover:bg-gray-100"
              (click)="deletarCliente(cliente.id)"
            >
              <svg class="w-10 h-10" aria-hidden="true">
                <use [attr.href]="'/sprite.svg#icon-trash'"></use>
              </svg>  
            </button>
          </div>
        </li>
        } @empty {
        <div class="flex flex-col justify-center items-center h-32 text-center">
          <svg class="w-12 h-12 text-on-surface-variant mb-2" aria-hidden="true">
            <use [attr.href]="'/sprite.svg#icon-pessoas'"></use>
          </svg>
          <p class="body-large text-on-surface-variant">
            Nenhum cliente encontrado.
          </p>
          <p class="body-medium text-on-surface-variant mt-1">
            Clique em "Adicionar Cliente" para começar.
          </p>
        </div>
        }
      </ul>
    }
  </div>
</section>
