@if (mostrarModalFornecedor()) {
<app-formulario-fornecedor
  (fechar)="closeFornecedorModal()"
  (salvo)="onFornecedorSalvo()"
></app-formulario-fornecedor>
}

<section
  role="region"
  aria-label="Fornecedores"
  class="flex flex-col p-4 bg-surface-container rounded-xl h-full"
>
  <header
    class="flex items-center gap-3 rounded-lg bg-surface p-6 z-5 shadow-lg"
    aria-label="CabeÃ§alho Fornecedores"
  >
    <svg class="icone-38" aria-hidden="true" focusable="false">
      <use [attr.href]="'/sprite.svg#icon-inventario'"></use>
    </svg>

    <h2 class="title-big leading-none text-on-surface">Fornecedores</h2>

    <div class="ms-auto">
      <app-botao
        label="Adicionar Fornecedor"
        (buttonClick)="abrirFornecedorModal()"
      ></app-botao>
    </div>
  </header>

  <div class="flex-1 rounded-lg px-4">
    @if (carregando()) {
      <div class="flex justify-center items-center h-32">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
        <span class="ml-2 text-on-surface-variant">Carregando fornecedores...</span>
      </div>
    } @else if (erro()) {
      <div class="flex flex-col justify-center items-center h-32 text-center">
        <svg class="w-12 h-12 text-error mb-2" aria-hidden="true">
          <use [attr.href]="'/sprite.svg#icon-error'"></use>
        </svg>
        <p class="text-error body-large">{{ erro() }}</p>
        <button 
          type="button"
          class="mt-2 px-4 py-2 bg-primary text-on-primary rounded-lg"
          (click)="carregarFornecedores()"
        >
          Tentar novamente
        </button>
      </div>
    } @else {
      <ul
        role="list"
        style="max-height: calc(100vh - 200px)"
        class="flex flex-col overflow-y-auto"
        aria-label="Lista de Fornecedores"
      >
        @for (fornecedor of fornecedores(); track fornecedor.id) {
        <li
          role="listitem"
          class="group relative rounded-xl border border-[#f0f0f0] bg-white p-4 shadow-soft m-2"
        >
          <app-fornecedor-item [fornecedor]="fornecedor" />

          <div
            class="absolute top-4 right-4 flex opacity-0 group-hover:opacity-100 transition-opacity duration-200"
          >
            <!-- Editar -->
            <button
              type="button"
              aria-label="Editar Fornecedor"
              class="flex h-10 w-10 items-center justify-center rounded-full bg-transparent text-on-surface-variant hover:bg-gray-100 cursor-pointer"
            >
              <svg class="w-6 h-6" aria-hidden="true">
                <use [attr.href]="'/sprite.svg#icon-editar'"></use>
              </svg>
            </button>

            <!-- Excluir -->
            <button
              type="button"
              aria-label="Excluir Fornecedor"
              class="flex h-10 w-10 items-center justify-center rounded-full bg-transparent text-on-surface-variant hover:bg-gray-100 cursor-pointer"
              (click)="deletarFornecedor(fornecedor.id)"
            >
              <svg class="w-10 h-10" aria-hidden="true">
                <use [attr.href]="'/sprite.svg#icon-trash'"></use>
              </svg>
            </button>
          </div>
        </li>
        } @empty {
        <p class="p-8 text-center body-large text-on-surface-variant">
          Nenhum fornecedor encontrado.
        </p>
        }
      </ul>
    }
  </div>
</section>
